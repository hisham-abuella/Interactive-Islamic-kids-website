// Translations for Islamic Kids Stories
// Supports English (en) and Arabic (ar)

const translations = {
    en: {
        // Navigation & UI
        navHome: "Home",
        navStories: "Stories",
        navLearn: "Learn",
        navAbout: "About",
        toggleLang: "AR",

        // Stars Counter
        starsLabel: "Stars",

        // Story Header
        storyTitle: "Prophet Adam - The First Human",
        storySubtitle: "An Interactive Adventure",
        progressComplete: "% Complete",

        // Welcome Modal
        modalGreeting: "Assalamu Alaikum!",
        modalQuestion: "What's your name, little one?",
        modalPlaceholder: "Enter your name...",
        modalButton: "Let's Begin!",
        welcomeMessage: "Welcome, {name}! Ready for an adventure?",

        // Scene 1: Creation
        scene1Title: "A Special Creation",
        scene1Text: "Before there were any people on Earth, Allah decided to create something very special. Allah told the angels: \"I am going to create a human being from clay.\"",
        scene1TapPrompt: "Tap to learn how Adam was made!",
        scene1Fact: "Allah created Adam from different types of clay from all over the Earth. That's why people today have different skin colors - beautiful shades of brown, tan, and more!",

        // Scene 2: The Soul
        scene2Title: "The Gift of Life",
        scene2Text: "After shaping Adam's body from clay, Allah blew the soul into him. Suddenly, Adam opened his eyes! He could see, hear, think, and feel. SubhanAllah!",
        scene2Question: "What was the first thing Adam said?",
        scene2AnswerCorrect: "Alhamdulillah",
        scene2AnswerWrong: "Hello",

        // Scene 3: Angels Prostrate
        scene3Title: "The Angels Bow Down",
        scene3Text: "Allah commanded all the angels to bow down to Adam as a sign of respect. All the angels obeyed Allah and prostrated to Adam right away!",
        scene3TapPrompt: "Tap to see the angels bow!",
        scene3Result: "The angels all bowed down to Adam!",

        // Scene 4: Iblis Refuses
        scene4Title: "One Who Refused",
        scene4Text: "But there was one who did not bow - Iblis (Shaytan). He was proud and arrogant. \"I am better than him!\" he said. \"You made me from fire and him from clay!\"",
        scene4Highlight: "Pride and arrogance are very bad! We should always be humble.",
        scene4Question: "How do you think Allah felt about Iblis refusing?",
        scene4Happy: "Happy",
        scene4Displeased: "Displeased",
        scene4Surprised: "Surprised",

        // Scene 5: Knowledge
        scene5Title: "Adam Learns Names",
        scene5Text: "Allah taught Adam the names of everything - animals, plants, objects, and more! When Allah asked the angels about these names, they didn't know. But Adam knew them all!",
        scene5Activity: "Match the names! Drag each item to its name!",
        scene5Sun: "Sun",
        scene5Tree: "Tree",
        scene5Bird: "Bird",

        // Scene 6: Hawa
        scene6Title: "A Companion for Adam",
        scene6Text: "Allah created Hawa (Eve) as a companion for Adam. They lived happily together in Jannah (Paradise), a beautiful garden with everything they could ever want!",
        scene6TapPrompt: "Tap to see what Jannah was like!",
        scene6Jannah1: "Beautiful flowers everywhere",
        scene6Jannah2: "Delicious fruits to eat",
        scene6Jannah3: "Rivers of pure water",
        scene6Jannah4: "Friendly animals all around",
        scene6Jannah5: "Perfect weather always",

        // Scene 7: The Forbidden Tree
        scene7Title: "One Rule",
        scene7Text: "Allah told Adam and Hawa they could enjoy everything in Jannah, but there was ONE tree they should not go near. \"Do not approach this tree,\" Allah said.",
        scene7Question: "Why do you think Allah gave them this rule?",
        scene7AnswerCorrect: "To test their obedience",
        scene7AnswerWrong: "To be mean",

        // Scene 8: The Mistake
        scene8Title: "A Mistake",
        scene8Text: "Shaytan whispered to Adam and Hawa and tricked them. They ate from the forbidden tree. As soon as they did, they realized they had made a big mistake!",
        scene8Highlight: "Shaytan is always trying to trick us. We must be careful!",
        scene8TapPrompt: "What can we learn from this?",
        scene8Lesson1: "Always listen to Allah's commands",
        scene8Lesson2: "Don't listen to Shaytan's whispers",
        scene8Lesson3: "Say \"A'udhu billahi min ash-shaytan ir-rajim\" to seek protection",

        // Scene 9: Repentance
        scene9Title: "Asking for Forgiveness",
        scene9Text1: "Adam and Hawa felt very sorry. They turned to Allah and said:",
        scene9Quran: "\"Our Lord, we have wronged ourselves, and if You do not forgive us and have mercy on us, we will surely be among the losers.\"",
        scene9Text2: "And SubhanAllah - Allah forgave them! Allah is the Most Merciful!",
        scene9Celebrate: "Allah Forgave Them!",

        // Scene 10: Life on Earth
        scene10Title: "A New Home on Earth",
        scene10Text: "Adam and Hawa were sent to live on Earth. Allah told them that Earth would be their home, and from them would come all the people of the world - including you!",
        scene10Activity: "Tap to see how all humans are connected!",
        scene10Counter: "People:",
        scene10AddBtn: "Add Person",

        // Lesson Box
        lessonTitle: "What We Learn from Prophet Adam",
        lesson1: "Allah created all humans - we are all one family!",
        lesson2: "Don't be proud like Iblis - always be humble",
        lesson3: "When we make mistakes, ask Allah for forgiveness",
        lesson4: "Allah is Most Merciful and loves to forgive",
        lessonInstruction: "Tap each lesson to mark it as learned!",

        // Dua Box
        duaTitle: "Adam's Dua for Forgiveness",
        duaTranslation: "\"Our Lord, we have wronged ourselves, and if You do not forgive us and have mercy upon us, we will surely be among the losers.\"",
        duaNote: "Say this dua when you make a mistake and want Allah's forgiveness!",
        memorizeBtn: "I want to memorize this!",
        memorizeSaved: "Added to your duas!",

        // Final Quiz
        quizTitle: "Story Complete! Final Challenge!",
        quizSubtitle: "Answer these questions to earn bonus stars!",
        questionOf: "Question {num} of {total}",
        q1Question: "What was Adam created from?",
        q1Option1: "Light",
        q1Option2: "Clay",
        q1Option3: "Fire",
        q1Option4: "Water",
        q2Question: "Who refused to bow to Adam?",
        q2Option1: "The angels",
        q2Option2: "Hawa",
        q2Option3: "Iblis (Shaytan)",
        q2Option4: "The animals",
        q3Question: "What happened when Adam asked Allah for forgiveness?",
        q3Option1: "Allah was angry",
        q3Option2: "Allah forgave him",
        q3Option3: "Nothing happened",
        q3Option4: "Adam had to wait",

        // Quiz Results
        resultsTitle: "Amazing Job!",
        resultsTitleWithName: "Amazing Job, {name}!",
        resultsScore: "You got {score} out of {total} correct!",
        totalStarsEarned: "Total Stars Earned:",

        // Video Section
        videoUnlock: "Bonus Video Unlocked!",
        videoSubtitle: "Watch this beautiful story about Prophet Adam!",

        // Navigation
        backToStories: "Back to Stories",
        nextStory: "Next Story: Prophet Ibrahim",

        // Footer
        moralTitle: "Today's Moral",
        moralText: "\"When you make a mistake, say sorry to Allah - He loves to forgive!\"",
        footerSubtitle: "Islamic Kids Stories",

        // Feedback Messages
        feedbackCorrect: "Correct! Great job!",
        feedbackTryAgain: "Try again!",
        feedbackPerfect: "Perfect! You got them all right!",
        feedbackTryElsewhere: "Hmm, try putting that somewhere else!",
        feedbackAllLessons: "Amazing! You learned all the lessons!",
        feedbackSubhanAllah: "SubhanAllah!",
        feedbackTrustAllah: "Yes! Ibrahim felt peaceful because he trusted Allah completely!",
        feedbackThinkAgain: "Think about it... Ibrahim trusted Allah!"
    },

    ar: {
        // Navigation & UI
        navHome: "الرئيسية",
        navStories: "القصص",
        navLearn: "تعلم",
        navAbout: "عنا",
        toggleLang: "EN",

        // Stars Counter
        starsLabel: "نجوم",

        // Story Header
        storyTitle: "النبي آدم - أول إنسان",
        storySubtitle: "مغامرة تفاعلية",
        progressComplete: "% مكتمل",

        // Welcome Modal
        modalGreeting: "السلام عليكم!",
        modalQuestion: "ما اسمك يا صغيري؟",
        modalPlaceholder: "أدخل اسمك...",
        modalButton: "!هيا نبدأ",
        welcomeMessage: "مرحباً {name}! هل أنت مستعد للمغامرة؟",

        // Scene 1: Creation
        scene1Title: "خلق مميز",
        scene1Text: "قبل أن يكون هناك أي بشر على الأرض، قرر الله أن يخلق شيئاً مميزاً جداً. قال الله للملائكة: \"إني خالق بشراً من طين.\"",
        scene1TapPrompt: "!اضغط لتعرف كيف خُلق آدم",
        scene1Fact: "خلق الله آدم من أنواع مختلفة من الطين من جميع أنحاء الأرض. لهذا السبب يملك الناس اليوم ألوان بشرة مختلفة - درجات جميلة من البني والأسمر وغيرها!",

        // Scene 2: The Soul
        scene2Title: "نعمة الحياة",
        scene2Text: "بعد أن شكّل الله جسد آدم من الطين، نفخ فيه الروح. فجأة، فتح آدم عينيه! أصبح يستطيع أن يرى ويسمع ويفكر ويشعر. سبحان الله!",
        scene2Question: "ما هو أول شيء قاله آدم؟",
        scene2AnswerCorrect: "الحمد لله",
        scene2AnswerWrong: "مرحباً",

        // Scene 3: Angels Prostrate
        scene3Title: "الملائكة تسجد",
        scene3Text: "أمر الله جميع الملائكة بالسجود لآدم تكريماً له. أطاعت جميع الملائكة الله وسجدت لآدم فوراً!",
        scene3TapPrompt: "!اضغط لترى الملائكة تسجد",
        scene3Result: "!سجدت جميع الملائكة لآدم",

        // Scene 4: Iblis Refuses
        scene4Title: "واحد رفض",
        scene4Text: "لكن كان هناك واحد لم يسجد - إبليس (الشيطان). كان متكبراً ومغروراً. قال: \"أنا خير منه! خلقتني من نار وخلقته من طين!\"",
        scene4Highlight: "!الكبر والغرور سيئان جداً! يجب أن نكون متواضعين دائماً",
        scene4Question: "كيف تعتقد أن الله شعر تجاه رفض إبليس؟",
        scene4Happy: "سعيد",
        scene4Displeased: "غاضب",
        scene4Surprised: "متفاجئ",

        // Scene 5: Knowledge
        scene5Title: "آدم يتعلم الأسماء",
        scene5Text: "علّم الله آدم أسماء كل شيء - الحيوانات والنباتات والأشياء وغيرها! عندما سأل الله الملائكة عن هذه الأسماء، لم يعرفوها. لكن آدم عرفها كلها!",
        scene5Activity: "!طابق الأسماء! اسحب كل عنصر إلى اسمه",
        scene5Sun: "الشمس",
        scene5Tree: "شجرة",
        scene5Bird: "طائر",

        // Scene 6: Hawa
        scene6Title: "رفيقة لآدم",
        scene6Text: "خلق الله حواء لتكون رفيقة لآدم. عاشا معاً بسعادة في الجنة، حديقة جميلة فيها كل ما يمكن أن يتمنياه!",
        scene6TapPrompt: "!اضغط لترى كيف كانت الجنة",
        scene6Jannah1: "زهور جميلة في كل مكان",
        scene6Jannah2: "فواكه لذيذة للأكل",
        scene6Jannah3: "أنهار من الماء النقي",
        scene6Jannah4: "حيوانات ودودة في كل مكان",
        scene6Jannah5: "طقس مثالي دائماً",

        // Scene 7: The Forbidden Tree
        scene7Title: "قاعدة واحدة",
        scene7Text: "أخبر الله آدم وحواء أنهما يستطيعان الاستمتاع بكل شيء في الجنة، لكن كانت هناك شجرة واحدة يجب ألا يقتربا منها. قال الله: \"ولا تقربا هذه الشجرة.\"",
        scene7Question: "لماذا تعتقد أن الله أعطاهما هذه القاعدة؟",
        scene7AnswerCorrect: "لاختبار طاعتهما",
        scene7AnswerWrong: "ليكون قاسياً",

        // Scene 8: The Mistake
        scene8Title: "خطأ",
        scene8Text: "وسوس الشيطان لآدم وحواء وخدعهما. أكلا من الشجرة المحرمة. بمجرد أن فعلا ذلك، أدركا أنهما ارتكبا خطأً كبيراً!",
        scene8Highlight: "!الشيطان يحاول دائماً خداعنا. يجب أن نكون حذرين",
        scene8TapPrompt: "ما الذي يمكننا تعلمه من هذا؟",
        scene8Lesson1: "استمع دائماً لأوامر الله",
        scene8Lesson2: "لا تستمع لوسوسات الشيطان",
        scene8Lesson3: "قل \"أعوذ بالله من الشيطان الرجيم\" للاستعاذة",

        // Scene 9: Repentance
        scene9Title: "طلب المغفرة",
        scene9Text1: "شعر آدم وحواء بالندم الشديد. توجها إلى الله وقالا:",
        scene9Quran: "\"ربنا ظلمنا أنفسنا وإن لم تغفر لنا وترحمنا لنكونن من الخاسرين.\"",
        scene9Text2: "وسبحان الله - غفر الله لهما! الله أرحم الراحمين!",
        scene9Celebrate: "!غفر الله لهما",

        // Scene 10: Life on Earth
        scene10Title: "منزل جديد على الأرض",
        scene10Text: "أُرسل آدم وحواء للعيش على الأرض. أخبرهما الله أن الأرض ستكون موطنهما، ومنهما سيأتي جميع البشر في العالم - بما فيهم أنت!",
        scene10Activity: "!اضغط لترى كيف يرتبط جميع البشر",
        scene10Counter: ":الأشخاص",
        scene10AddBtn: "أضف شخصاً",

        // Lesson Box
        lessonTitle: "ما نتعلمه من النبي آدم",
        lesson1: "!خلق الله جميع البشر - نحن جميعاً عائلة واحدة",
        lesson2: "لا تكن متكبراً مثل إبليس - كن متواضعاً دائماً",
        lesson3: "عندما نخطئ، نستغفر الله",
        lesson4: "الله أرحم الراحمين ويحب أن يغفر",
        lessonInstruction: "!اضغط على كل درس لتحديده كما تعلمته",

        // Dua Box
        duaTitle: "دعاء آدم للمغفرة",
        duaTranslation: "\"ربنا ظلمنا أنفسنا وإن لم تغفر لنا وترحمنا لنكونن من الخاسرين.\"",
        duaNote: "!قل هذا الدعاء عندما تخطئ وتريد مغفرة الله",
        memorizeBtn: "!أريد حفظ هذا",
        memorizeSaved: "!تمت إضافته إلى أدعيتك",

        // Final Quiz
        quizTitle: "!اكتملت القصة! التحدي الأخير",
        quizSubtitle: "!أجب على هذه الأسئلة لكسب نجوم إضافية",
        questionOf: "السؤال {num} من {total}",
        q1Question: "من ماذا خُلق آدم؟",
        q1Option1: "نور",
        q1Option2: "طين",
        q1Option3: "نار",
        q1Option4: "ماء",
        q2Question: "من رفض السجود لآدم؟",
        q2Option1: "الملائكة",
        q2Option2: "حواء",
        q2Option3: "إبليس (الشيطان)",
        q2Option4: "الحيوانات",
        q3Question: "ماذا حدث عندما استغفر آدم الله؟",
        q3Option1: "غضب الله",
        q3Option2: "غفر الله له",
        q3Option3: "لم يحدث شيء",
        q3Option4: "كان على آدم الانتظار",

        // Quiz Results
        resultsTitle: "!عمل رائع",
        resultsTitleWithName: "عمل رائع يا {name}!",
        resultsScore: "!أجبت على {score} من {total} بشكل صحيح",
        totalStarsEarned: ":إجمالي النجوم المكتسبة",

        // Video Section
        videoUnlock: "!تم فتح الفيديو الإضافي",
        videoSubtitle: "!شاهد هذه القصة الجميلة عن النبي آدم",

        // Navigation
        backToStories: "العودة للقصص",
        nextStory: "القصة التالية: النبي إبراهيم",

        // Footer
        moralTitle: "درس اليوم",
        moralText: "\"!عندما تخطئ، استغفر الله - فهو يحب أن يغفر\"",
        footerSubtitle: "قصص إسلامية للأطفال",

        // Feedback Messages
        feedbackCorrect: "!صحيح! أحسنت",
        feedbackTryAgain: "!حاول مرة أخرى",
        feedbackPerfect: "!ممتاز! أجبت على الكل بشكل صحيح",
        feedbackTryElsewhere: "!حسناً، حاول وضعه في مكان آخر",
        feedbackAllLessons: "!رائع! تعلمت جميع الدروس",
        feedbackSubhanAllah: "!سبحان الله",
        feedbackTrustAllah: "!نعم! شعر إبراهيم بالسلام لأنه وثق بالله تماماً",
        feedbackThinkAgain: "!فكر في الأمر... إبراهيم وثق بالله"
    }
};

// Get current language from localStorage
function getCurrentLanguage() {
    return localStorage.getItem('islamicKidsLang') || 'en';
}

// Get translated text by key
function getText(key, replacements) {
    const lang = getCurrentLanguage();
    let text = translations[lang][key] || translations['en'][key] || key;

    // Handle replacements like {name}, {score}, {total}
    if (replacements) {
        for (const [placeholder, value] of Object.entries(replacements)) {
            text = text.replace('{' + placeholder + '}', value);
        }
    }

    return text;
}

// Set language and update page
function setLanguage(lang) {
    localStorage.setItem('islamicKidsLang', lang);
    document.documentElement.lang = lang;
    document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';

    // Update all elements with data-i18n attribute
    document.querySelectorAll('[data-i18n]').forEach(function(el) {
        const key = el.dataset.i18n;
        el.textContent = getText(key);
    });

    // Update all elements with data-i18n-placeholder attribute (for inputs)
    document.querySelectorAll('[data-i18n-placeholder]').forEach(function(el) {
        const key = el.dataset.i18nPlaceholder;
        el.placeholder = getText(key);
    });

    // Update toggle button
    updateLanguageToggle(lang);

    // Dispatch event for other scripts to react
    document.dispatchEvent(new CustomEvent('languageChanged', { detail: { lang: lang } }));
}

// Update language toggle button appearance
function updateLanguageToggle(lang) {
    const toggleBtns = document.querySelectorAll('.lang-toggle-btn');
    toggleBtns.forEach(function(btn) {
        btn.textContent = lang === 'en' ? 'AR' : 'EN';
        btn.setAttribute('data-current', lang);
    });
}

// Initialize language on page load
function initializeLanguage() {
    const lang = getCurrentLanguage();
    document.documentElement.lang = lang;
    document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
    updateLanguageToggle(lang);
}

// Toggle between languages
function toggleLanguage() {
    const currentLang = getCurrentLanguage();
    const newLang = currentLang === 'en' ? 'ar' : 'en';
    setLanguage(newLang);
}

// Export functions for use in other scripts
window.i18n = {
    getText: getText,
    setLanguage: setLanguage,
    getCurrentLanguage: getCurrentLanguage,
    toggleLanguage: toggleLanguage,
    initializeLanguage: initializeLanguage
};
